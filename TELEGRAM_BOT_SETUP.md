# ü§ñ Telegram Bot - –ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

## ‚úÖ –©–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ:

### üéØ –û—Å–Ω–æ–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó:
- ‚úÖ **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è** —á–µ—Ä–µ–∑ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π –ª—ñ–Ω–∫ –∑ —Å–∞–π—Ç—É
- ‚úÖ **–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–µ –º–µ–Ω—é** –∑ –∫–Ω–æ–ø–∫–∞–º–∏
- ‚úÖ **–†–µ–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–∑–∞–≤–¥–∞–Ω–Ω—è, –±–∞–ª–∞–Ω—Å, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
- ‚úÖ **Rich notifications** –∑ inline –∫–Ω–æ–ø–∫–∞–º–∏
- ‚úÖ **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–ø–æ–≤—ñ—â–µ–Ω—å** –ø—Ä—è–º–æ –≤ –±–æ—Ç—ñ

### üìã –ö–æ–º–∞–Ω–¥–∏ –±–æ—Ç–∞:
- `/start` - –ü–æ—á–∞—Ç–æ–∫ —Ä–æ–±–æ—Ç–∏ –∑ –±–æ—Ç–æ–º
- `/help` - –î–æ–≤—ñ–¥–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞—Ö
- `/tasks` –∞–±–æ `/missions` - –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω—å
- `/balance` - –ë–∞–ª–∞–Ω—Å —Ç–∞ –∫—Ä–µ–¥–∏—Ç–∏
- `/stats` –∞–±–æ `/statistiques` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `/messages` - –û—Å—Ç–∞–Ω–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- `/offers` –∞–±–æ `/offres` - –ú–æ—ó –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó
- `/settings` –∞–±–æ `/parametres` - –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–ø–æ–≤—ñ—â–µ–Ω—å

### ‚å®Ô∏è –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–µ –º–µ–Ω—é:
```
üìã Mes missions      üîç Trouver une mission
üí¨ Messages          üéØ Mes Offres
üí∞ Mon Solde         üìä Statistiques
üë§ Mon Profil        ‚öôÔ∏è Param√®tres
üÜò Aide / Support
```

### üîî –¢–∏–ø–∏ —Å–ø–æ–≤—ñ—â–µ–Ω—å:
1. **–ù–æ–≤—ñ –∑–∞–≤–¥–∞–Ω–Ω—è** - –∑ inline –∫–Ω–æ–ø–∫–∞–º–∏ "Voir" —Ç–∞ "Faire une offre"
2. **–ù–æ–≤—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è** - –∑ preview —Ç–∞ –∫–Ω–æ–ø–∫–æ—é "R√©pondre"
3. **–ü—Ä–∏–π–Ω—è—Ç—ñ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó** - –∑ –¥–µ—Ç–∞–ª—è–º–∏
4. **–ù–æ–≤—ñ –≤—ñ–¥–≥—É–∫–∏** - –∑—ñ—Ä–∫–∏ + –∫–æ–º–µ–Ω—Ç–∞—Ä
5. **–ü–ª–∞—Ç–µ–∂—ñ** - —Å—É–º–∞ + –∑–∞–≤–¥–∞–Ω–Ω—è
6. **–ù–∏–∑—å–∫–∏–π –±–∞–ª–∞–Ω—Å** - –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è
7. **–°–∫–∞—Å—É–≤–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω—å** - –∑ –ø—Ä–∏—á–∏–Ω–æ—é
8. **–ó–∞–∫—ñ–Ω—á–µ–Ω–Ω—è –ø—ñ–¥–ø–∏—Å–∫–∏** - –Ω–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è

---

## üöÄ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ:

### 1. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –±–æ—Ç–∞ –≤ BotFather

–í—ñ–¥–∫—Ä–∏–π Telegram, –∑–Ω–∞–π–¥–∏ [@BotFather](https://t.me/BotFather) —ñ —Å—Ç–≤–æ—Ä–∏ –±–æ—Ç–∞:

```
/newbot
–ù–∞–∑–≤–∞ –±–æ—Ç–∞: ProchePro Bot
Username: ProchePro_bot (–∞–±–æ —ñ–Ω—à–∏–π –¥–æ—Å—Ç—É–ø–Ω–∏–π)
```

**–ó–±–µ—Ä—ñ–≥–∞–π TOKEN!** –í—ñ–Ω –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫: `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`

### 2. –î–æ–¥–∞–π TOKEN –≤ .env

```bash
cd /var/www/prochepro.fr/backend
nano .env
```

–î–æ–¥–∞–π:
```env
TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz
TELEGRAM_BOT_USERNAME=ProchePro_bot
```

### 3. –ù–∞–ª–∞—à—Ç—É–π –∫–æ–º–∞–Ω–¥–∏ –≤ BotFather

–í—ñ–¥–∫—Ä–∏–π [@BotFather](https://t.me/BotFather):

```
/mybots
‚Üí –í–∏–±–µ—Ä–∏ —Å–≤–æ–≥–æ –±–æ—Ç–∞
‚Üí Edit Bot
‚Üí Edit Commands
```

–í—Å—Ç–∞–≤—å —Ü–µ:
```
start - D√©marrer le bot
help - Aide et commandes
tasks - Voir mes missions
balance - Mon solde et cr√©dits
stats - Mes statistiques
messages - Messages r√©cents
offers - Mes offres actives
settings - Param√®tres de notifications
```

### 4. –í—Å—Ç–∞–Ω–æ–≤–∏ Webhook

**–í–∞—Ä—ñ–∞–Ω—Ç A: Webhook (—Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –¥–ª—è production)**

```bash
curl -X POST "https://api.telegram.org/bot<YOUR_BOT_TOKEN>/setWebhook" \
  -d "url=https://api.prochepro.fr/api/telegram/webhook"
```

–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ webhook:
```bash
curl "https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getWebhookInfo"
```

**–í–∞—Ä—ñ–∞–Ω—Ç B: Long Polling (–¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è)**

```bash
cd /var/www/prochepro.fr/backend
php artisan telegram:bot
```

–ê–±–æ –¥–æ–¥–∞–π –≤ cron:
```bash
* * * * * cd /var/www/prochepro.fr/backend && php artisan telegram:bot --once >> /dev/null 2>&1
```

### 5. –ó–∞–≤–∞–Ω—Ç–∞–∂ —Ñ–∞–π–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**Backend —Ñ–∞–π–ª–∏:**
```
backend/app/Http/Controllers/Api/TelegramWebhookController.php
backend/app/Services/TelegramNotificationService.php
backend/app/Console/Commands/TelegramBotCommand.php
```

### 6. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ backend

```bash
cd /var/www/prochepro.fr/backend
php artisan config:clear
php artisan cache:clear
```

---

## üé® –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ–ø–∏—Å—É –±–æ—Ç–∞ –≤ BotFather

### Description (—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –±–∞—á–∞—Ç—å –≤ —Å–ø–∏—Å–∫—É –±–æ—Ç—ñ–≤):

```
ü§ñ ProchePro Bot Officiel

Recevez instantan√©ment:
üîî Nouvelles missions pr√®s de chez vous
üí¨ Messages des clients
‚ö° Mises √† jour en temps r√©el
üìä Statistiques et solde

Connectez votre compte depuis prochepro.fr
```

–í BotFather:
```
/mybots
‚Üí –í–∏–±–µ—Ä–∏ –±–æ—Ç–∞
‚Üí Edit Bot
‚Üí Edit Description
```

### About (–∫–æ—Ä–æ—Ç–∫–∞ –≤–µ—Ä—Å—ñ—è):

```
Bot officiel ProchePro - Notifications et gestion de missions en temps r√©el
```

–í BotFather:
```
/mybots
‚Üí –í–∏–±–µ—Ä–∏ –±–æ—Ç–∞
‚Üí Edit Bot
‚Üí Edit About Text
```

### Botpic (–∞–≤–∞—Ç–∞—Ä–∫–∞):

–ó–∞–≤–∞–Ω—Ç–∞–∂ –ª–æ–≥–æ ProchePro (512x512 px, PNG)

```
/mybots
‚Üí –í–∏–±–µ—Ä–∏ –±–æ—Ç–∞
‚Üí Edit Bot
‚Üí Edit Botpic
```

---

## üîó –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

### –ù–∞ frontend (–≤ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞):

–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞—Ç–∏—Å–∫–∞—î –∫–Ω–æ–ø–∫—É "Connecter Telegram" —ñ –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è:
```
https://t.me/ProchePro_bot?start=connect_<USER_ID_BASE64>
```

–ü—Ä–∏–∫–ª–∞–¥ –∫–æ–¥—É –¥–ª—è frontend:
```javascript
const userId = user.id;
const encodedUserId = btoa(`connect_${userId}`);
const telegramLink = `https://t.me/${TELEGRAM_BOT_USERNAME}?start=${encodedUserId}`;
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è:

–ë–æ—Ç –æ—Ç—Ä–∏–º—É—î `/start connect_123`, –¥–µ–∫–æ–¥—É—î, –∑–Ω–∞—Ö–æ–¥–∏—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —ñ –ø—ñ–¥–∫–ª—é—á–∞—î Telegram Chat ID.

---

## üì± –Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±–æ—Ç:

### 1. –ü–µ—Ä—à–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è:
- –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞—Ç–∏—Å–∫–∞—î "Connecter Telegram" –Ω–∞ —Å–∞–π—Ç—ñ
- –í—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è Telegram ‚Üí `/start`
- –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—ñ–¥–∫–ª—é—á–∞—î –∞–∫–∫–∞—É–Ω—Ç
- –ó'—è–≤–ª—è—î—Ç—å—Å—è —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–µ –º–µ–Ω—é

### 2. –ü–µ—Ä–µ–≥–ª—è–¥ –∑–∞–≤–¥–∞–Ω—å:
```
üìã Mes missions
```
–ü–æ–∫–∞–∑—É—î:
- –ê–∫—Ç–∏–≤–Ω—ñ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó
- –°—Ç–∞—Ç—É—Å (‚è≥ En attente / ‚úÖ Accept√©e)
- –ë—é–¥–∂–µ—Ç —ñ –ª–æ–∫–∞—Ü—ñ—è
- Inline –∫–Ω–æ–ø–∫–∏ –¥–ª—è —à–≤–∏–¥–∫–∏—Ö –¥—ñ–π

### 3. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å—É:
```
üí∞ Mon Solde
```
–ü–æ–∫–∞–∑—É—î:
- –ö—Ä–µ–¥–∏—Ç–∏
- –¢–∏–ø –ø—ñ–¥–ø–∏—Å–∫–∏ (üÜì Gratuit / ‚≠ê Premium / üèÜ Business)
- –ü–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è —è–∫—â–æ –∫—Ä–µ–¥–∏—Ç—ñ–≤ –º–∞–ª–æ

### 4. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
```
üìä Statistiques
```
–ü–æ–∫–∞–∑—É—î:
- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ–π
- –í—ñ–¥—Å–æ—Ç–æ–∫ –ø—Ä–∏–π–Ω—è—Ç–∏—Ö
- –ó–∞–≤–µ—Ä—à–µ–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è
- –°–µ—Ä–µ–¥–Ω—ñ–π —Ä–µ–π—Ç–∏–Ω–≥ ‚≠ê

### 5. –û—Å—Ç–∞–Ω–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:
```
üí¨ Messages
```
–ü–æ–∫–∞–∑—É—î:
- 5 –æ—Å—Ç–∞–Ω–Ω—ñ—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
- Preview —Ç–µ–∫—Å—Ç—É
- –í—ñ–¥ –∫–æ–≥–æ
- –õ—ñ–Ω–∫ –¥–ª—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ

### 6. –ú–æ—ó –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó:
```
üéØ Mes Offres
```
–ü–æ–∫–∞–∑—É—î:
- –ü—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó –≤ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—ñ
- –ü—Ä–∏–π–Ω—è—Ç—ñ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó
- –°—É–º–∞ —Ç–∞ –Ω–∞–∑–≤–∞ –∑–∞–≤–¥–∞–Ω–Ω—è

---

## üîî –ü—Ä–∏–∫–ª–∞–¥–∏ —Å–ø–æ–≤—ñ—â–µ–Ω—å:

### –ù–æ–≤–µ –∑–∞–≤–¥–∞–Ω–Ω—è:
```
üîî Nouvelle Mission dans votre secteur!

üìã M√©nage appartement 3 pi√®ces
üìç Paris 15√®me (75015)
üí∞ Budget: 50‚Ç¨ - 80‚Ç¨
üè∑Ô∏è Cat√©gorie: M√©nage

‚ö° Soyez rapide! Les meilleures offres partent vite!

[üëÄ Voir la mission] [‚úÖ Faire une offre]
```

### –ù–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:
```
üí¨ Nouveau Message

Mission: M√©nage appartement
De: Marie Dupont

"Bonjour, pouvez-vous venir demain √† 14h?"

[üí¨ R√©pondre]
```

### –ü—Ä–∏–π–Ω—è—Ç–∞ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—è:
```
‚úÖ Votre offre a √©t√© accept√©e!

Mission: M√©nage appartement 3 pi√®ces
Montant: 65‚Ç¨
Client: Marie Dupont

üëâ Voir les d√©tails: https://prochepro.fr/tasks/123
```

### –ù–æ–≤–∏–π –≤—ñ–¥–≥—É–∫:
```
üåü Nouvel Avis Re√ßu!

Note: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5)
Mission: M√©nage appartement

Commentaire: "Travail impeccable, tr√®s professionnel!"

üèÜ Excellent travail! Continuez ainsi!
```

---

## ‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–ø–æ–≤—ñ—â–µ–Ω—å –≤ –±–æ—Ç—ñ:

–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞—Ç–∏—Å–∫–∞—î `‚öôÔ∏è Param√®tres` —ñ –±–∞—á–∏—Ç—å:

```
üîî Param√®tres de notifications

Choisissez les notifications que vous souhaitez recevoir :

‚úÖ Nouvelles missions dans mon secteur
‚úÖ Messages des clients
‚úÖ R√©ponses √† mes offres
‚úÖ Notifications syst√®me

[–ö–Ω–æ–ø–∫–∏ –¥–ª—è toggle –∫–æ–∂–Ω–æ–≥–æ —Ç–∏–ø—É]
```

–ù–∞—Ç–∏—Å–Ω—É–≤—à–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É, –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–º–∏–∫–∞—î/–≤–∏–º–∏–∫–∞—î —Ç–∏–ø —Å–ø–æ–≤—ñ—â–µ–Ω—å.

---

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è:

### 1. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –±–æ—Ç–∞:

```bash
curl "https://api.telegram.org/bot<YOUR_TOKEN>/getMe"
```

–ú–∞—î –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ —ñ–Ω—Ñ—É –ø—Ä–æ –±–æ—Ç–∞.

### 2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ webhook:

```bash
curl "https://api.telegram.org/bot<YOUR_TOKEN>/getWebhookInfo"
```

–ú–∞—î –ø–æ–∫–∞–∑–∞—Ç–∏ `url: https://api.prochepro.fr/api/telegram/webhook`

### 3. –¢–µ—Å—Ç–æ–≤–µ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è:

–í –∫–æ–¥—ñ backend:
```php
use App\Services\TelegramNotificationService;
use App\Models\User;

$user = User::find(1); // –¢–≤—ñ–π ID
TelegramNotificationService::sendToUser($user, "üß™ <b>Test!</b>\n\n–¶–µ —Ç–µ—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ ProchePro Bot!");
```

### 4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏:

```bash
tail -f /var/www/prochepro.fr/backend/storage/logs/laravel.log | grep -i telegram
```

---

## üîß –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –ø–æ–¥—ñ—è–º–∏:

### –í MessageController (–≤–∂–µ –¥–æ–¥–∞–Ω–æ):

```php
// –í—ñ–¥–ø—Ä–∞–≤–∫–∞ Telegram —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–∏ –Ω–æ–≤–æ–º—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—ñ
try {
    TelegramNotificationService::notifyNewMessage(
        $recipient,
        $task,
        $message->body,
        $sender->name
    );
} catch (\Throwable $e) {
    \Log::error('Telegram notification failed', ['error' => $e->getMessage()]);
}
```

### –í OfferController (–¥–æ–¥–∞—Ç–∏):

```php
// –ü—Ä–∏ –ø—Ä–∏–π–Ω—è—Ç—Ç—ñ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó
use App\Services\TelegramNotificationService;

if ($offer->status === 'accepted') {
    try {
        TelegramNotificationService::notifyOfferAccepted($offer->user, $offer);
    } catch (\Throwable $e) {
        \Log::error('Telegram notification failed');
    }
}
```

### –í TaskController (–¥–æ–¥–∞—Ç–∏):

```php
// –ü—Ä–∏ —Å–∫–∞—Å—É–≤–∞–Ω–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è
try {
    TelegramNotificationService::notifyTaskCancelled($prestataire, $task, $reason);
} catch (\Throwable $e) {
    \Log::error('Telegram notification failed');
}
```

### –ü—Ä–∏ –Ω–æ–≤–æ–º—É –≤—ñ–¥–≥—É–∫—É:

```php
try {
    TelegramNotificationService::notifyNewReview($user, $rating, $review, $task);
} catch (\Throwable $e) {
    \Log::error('Telegram notification failed');
}
```

---

## üìä –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥:

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞:

```bash
# –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
mysql -u root -p prochepro_db -e "SELECT COUNT(*) FROM messenger_settings WHERE telegram_enabled = 1"

# –û—Å—Ç–∞–Ω–Ω—ñ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
mysql -u root -p prochepro_db -e "SELECT user_id, telegram_chat_id, created_at FROM messenger_settings WHERE telegram_enabled = 1 ORDER BY updated_at DESC LIMIT 10"
```

### –õ–æ–≥–∏ Telegram:

```bash
# –ü–æ–∫–∞–∑–∞—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ –ø–æ–º–∏–ª–∫–∏
tail -100 /var/www/prochepro.fr/backend/storage/logs/laravel.log | grep -i "telegram" | grep -i "error"

# –ü–æ–∫–∞–∑–∞—Ç–∏ —É—Å–ø—ñ—à–Ω—ñ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏
tail -100 /var/www/prochepro.fr/backend/storage/logs/laravel.log | grep -i "Telegram message sent"
```

---

## üêõ Troubleshooting:

### –ë–æ—Ç –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î:

1. **–ü–µ—Ä–µ–≤—ñ—Ä TOKEN:**
   ```bash
   php artisan tinker
   >>> config('services.telegram.bot_token')
   ```

2. **–ü–µ—Ä–µ–≤—ñ—Ä webhook:**
   ```bash
   curl "https://api.telegram.org/bot<TOKEN>/getWebhookInfo"
   ```

3. **–ü–µ—Ä–µ–≤—ñ—Ä –º–∞—Ä—à—Ä—É—Ç–∏:**
   ```bash
   php artisan route:list | grep telegram
   ```

### –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç—å:

1. **–ü–µ—Ä–µ–≤—ñ—Ä —á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø—ñ–¥–∫–ª—é—á–∏–≤ Telegram:**
   ```sql
   SELECT * FROM messenger_settings WHERE user_id = <USER_ID>;
   ```

2. **–ü–µ—Ä–µ–≤—ñ—Ä –ª–æ–≥–∏:**
   ```bash
   tail -f storage/logs/laravel.log | grep Telegram
   ```

3. **–¢–µ—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:**
   ```bash
   curl -X POST "https://api.telegram.org/bot<TOKEN>/sendMessage" \
     -d "chat_id=<CHAT_ID>" \
     -d "text=Test"
   ```

---

## ‚úÖ –ß–µ–∫–ª—ñ—Å—Ç –ø—ñ—Å–ª—è deployment:

- [ ] –ë–æ—Ç —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –≤ BotFather
- [ ] TOKEN –¥–æ–¥–∞–Ω–∏–π –≤ `.env`
- [ ] –ö–æ–º–∞–Ω–¥–∏ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –≤ BotFather
- [ ] Description —Ç–∞ About –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ
- [ ] Botpic –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π
- [ ] Webhook –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π
- [ ] Backend —Ñ–∞–π–ª–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ
- [ ] Cache –æ—á–∏—â–µ–Ω–∏–π
- [ ] –¢–µ—Å—Ç–æ–≤–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –ø—Ä–æ–π—à–ª–æ —É—Å–ø—ñ—à–Ω–æ
- [ ] –¢–µ—Å—Ç–æ–≤–µ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –æ—Ç—Ä–∏–º–∞–Ω–æ
- [ ] Inline –∫–Ω–æ–ø–∫–∏ –ø—Ä–∞—Ü—é—é—Ç—å
- [ ] –í—Å—ñ –∫–æ–º–∞–Ω–¥–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å
- [ ] –ú–µ–Ω—é –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è

---

## üéâ –ë–æ—Ç –≥–æ—Ç–æ–≤–∏–π!

–ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π Telegram –±–æ—Ç –∑:
- ‚úÖ –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–º –º–µ–Ω—é
- ‚úÖ –†–µ–∞–ª—å–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- ‚úÖ Rich notifications –∑ –∫–Ω–æ–ø–∫–∞–º–∏
- ‚úÖ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏ —Å–ø–æ–≤—ñ—â–µ–Ω—å
- ‚úÖ –ü–æ–≤–Ω–æ—é —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—î—é –∑ —Å–∞–π—Ç–æ–º

**–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ —Ç–µ–ø–µ—Ä –æ—Ç—Ä–∏–º—É—é—Ç—å –º–∏—Ç—Ç—î–≤—ñ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ –≤—Å—ñ –ø–æ–¥—ñ—ó –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤ Telegram!**
